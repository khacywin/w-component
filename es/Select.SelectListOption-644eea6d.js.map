{"version":3,"file":"Select.SelectListOption-644eea6d.js","sources":["../components/Form/Select/Select.SelectListOption.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { borderRadius, lineOverflow, space } from \"css/base\";\r\n\r\nimport ButtonAction from \"components/Button/ButtonAction\";\r\nimport Dropdown from \"components/Dropdown\";\r\nimport Icon from \"components/Icon\";\r\nimport InputStyle from \"css/elements/InputStyle\";\r\nimport { TSelectOption } from \"util/type\";\r\nimport generatedId from \"util/generatedId\";\r\nimport styled from \"styled-components\";\r\n\r\ninterface IProps {\r\n  list: TSelectOption[];\r\n  value: string | string[]; // HTML wrap is showed\r\n  isSearch?: boolean;\r\n  isMultiple?: boolean;\r\n  fnSelect?: (val: string | string[]) => void;\r\n}\r\n\r\nexport default React.memo((props: IProps) => {\r\n  const [originList, setOriginList] = useState<TSelectOption[]>([]);\r\n  const [list, setList] = useState<TSelectOption[]>([]);\r\n  const refFormSearch = useRef<HTMLInputElement>();\r\n\r\n  useEffect(() => {\r\n    setOriginList(props.list);\r\n    setList(props.list);\r\n  }, [props.list]);\r\n\r\n  const handleRemove = useCallback(\r\n    (val: string) => {\r\n      const _value: any = props.value;\r\n      props.fnSelect?.(_value.filter((item: string) => item !== val));\r\n    },\r\n    [props]\r\n  );\r\n\r\n  /**\r\n   * @param {string | number} val\r\n   *\r\n   * Display label of value selected\r\n   */\r\n  const renderLabel = useCallback(\r\n    (val: string | string[]) => {\r\n      if ((!val || val.length === 0) && !props.isMultiple) {\r\n        // Return default value\r\n        // If variable 'isMultiple' is true, it will be '--Select'\r\n        // Else it is first of item in List\r\n        return originList[0]?.label;\r\n      } else if (props.isMultiple && Array.isArray(val)) {\r\n        // Return list item\r\n        return val.map(\r\n          (item: any, key: number) =>\r\n            item && (\r\n              <Item key={key}>\r\n                <span\r\n                  onClick={(e: React.MouseEvent) => {\r\n                    e.stopPropagation();\r\n                  }}\r\n                >\r\n                  {\r\n                    originList.find(\r\n                      (option: TSelectOption) => option.value === item\r\n                    )?.label\r\n                  }\r\n                </span>\r\n                <ButtonAction\r\n                  action={(e: React.MouseEvent) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    handleRemove(item);\r\n                  }}\r\n                >\r\n                  <Icon small icon=\"i-close\" />\r\n                </ButtonAction>\r\n              </Item>\r\n            )\r\n        );\r\n      } else if (typeof val === \"string\") {\r\n        return (\r\n          originList.find((option: TSelectOption) => option.value === val)\r\n            ?.label || originList[0]?.label\r\n        );\r\n      }\r\n\r\n      // If val is JSX.Element is it return itself\r\n      return val;\r\n    },\r\n    [handleRemove, originList, props.isMultiple]\r\n  );\r\n\r\n  /**\r\n   * @param {index} index\r\n   */\r\n  const select = useCallback(\r\n    (val: any) => {\r\n      let _value: any;\r\n      /**\r\n       * TODO\r\n       * Reset form search\r\n       * Only when props.isSearch is true\r\n       */\r\n      if (props.isSearch && !props.isMultiple) {\r\n        refFormSearch.current.value = \"\";\r\n        setList(originList);\r\n      }\r\n\r\n      if (props.isMultiple && Array.isArray(props.value)) {\r\n        const _preVal: string[] = !props.value ? [] : [...props.value];\r\n\r\n        if (!_preVal.some((item: string) => item === val) && val !== \"\") {\r\n          _value = [..._preVal, val];\r\n        } else {\r\n          _value = props.value;\r\n        }\r\n      } else {\r\n        _value = val;\r\n      }\r\n\r\n      props.fnSelect?.(_value);\r\n    },\r\n    [props, originList]\r\n  );\r\n\r\n  /**\r\n   * @param {string} val\r\n   */\r\n  const search = useCallback(\r\n    (val: string) => {\r\n      setList(\r\n        originList.filter(\r\n          (option: TSelectOption) =>\r\n            option.label.toUpperCase().indexOf(val.toUpperCase()) >= 0\r\n        )\r\n      );\r\n    },\r\n    [originList]\r\n  );\r\n\r\n  const renderOptions = useCallback(\r\n    (listOptions: TSelectOption[]) => {\r\n      const _id = generatedId(\"select-list\");\r\n      return listOptions.map((option: TSelectOption, index: any) => {\r\n        if (option.group) {\r\n          return (\r\n            <SelectGroup key={index} className=\"select-group\">\r\n              <div>\r\n                <strong>{option.group.label}</strong>\r\n              </div>\r\n              <ul>{renderOptions(option.group.options)}</ul>\r\n            </SelectGroup>\r\n          );\r\n        } else\r\n          return (\r\n            <li\r\n              className=\"select-option-item\"\r\n              onClick={() => select(option.value)}\r\n              key={_id + index}\r\n            >\r\n              {option.label}\r\n            </li>\r\n          );\r\n      });\r\n    },\r\n    [select]\r\n  );\r\n\r\n  return (\r\n    <Dropdown\r\n      full\r\n      clickOut={!props.isMultiple}\r\n      className=\"w-select-wrap\"\r\n      dropdown_menu={\r\n        <SelectLists className=\"select-options\">\r\n          {props.isSearch && (\r\n            <SelectListSearch className=\"w-select-options-search\">\r\n              <Icon icon=\"i-search\" />\r\n              <input\r\n                ref={refFormSearch}\r\n                placeholder=\"Search ...\"\r\n                type=\"text\"\r\n                autoFocus={true}\r\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n                  search(e.target.value)\r\n                }\r\n              />\r\n            </SelectListSearch>\r\n          )}\r\n          <ul>{renderOptions(list)}</ul>\r\n        </SelectLists>\r\n      }\r\n    >\r\n      <SelectListValue\r\n        minHeight={props.isMultiple && 39}\r\n        className=\"w-select-value\"\r\n      >\r\n        {props.value && props.value.length > 0 ? (\r\n          renderLabel(props.value)\r\n        ) : (\r\n          <PlaceHolder>Select</PlaceHolder>\r\n        )}\r\n        <i className=\"i-arrow-down \" />\r\n      </SelectListValue>\r\n    </Dropdown>\r\n  );\r\n});\r\n\r\nconst SelectListSearch = styled.div`\r\n  ${space.P2.a};\r\n  display: flex;\r\n  align-items: center;\r\n  border-bottom: 1px solid var(--border);\r\n  input {\r\n    ${InputStyle};\r\n  }\r\n`;\r\n\r\nconst SelectListValue = styled.div<{ minHeight: number }>`\r\n  cursor: pointer;\r\n  user-select: none;\r\n  line-height: 20px;\r\n  position: relative;\r\n  ${({ minHeight }) => minHeight && `min-height: ${minHeight}px;`};\r\n  ${space.P2.a};\r\n  ${lineOverflow.one};\r\n\r\n  & > i {\r\n    position: absolute;\r\n    right: 5px;\r\n    bottom: 7px;\r\n  }\r\n`;\r\n\r\nconst SelectLists = styled.div`\r\n  background-color: var(--backgroundContent);\r\n  width: 100%;\r\n  overflow-y: hidden;\r\n  ul {\r\n    overflow-x: hidden;\r\n    overflow-y: auto;\r\n    max-height: 400px;\r\n    ::-webkit-scrollbar {\r\n      width: 2px;\r\n    }\r\n\r\n    li {\r\n      width: 100%;\r\n      list-style: none;\r\n      cursor: pointer;\r\n      ${space.P3.a};\r\n      ${borderRadius.normal};\r\n\r\n      &:hover {\r\n        background-color: var(--backgroundOpacity);\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst SelectGroup = styled.div`\r\n  margin-top: 5px;\r\n\r\n  strong {\r\n    user-select: none;\r\n    padding-left: 8px;\r\n  }\r\n\r\n  ul {\r\n    padding-left: 7px;\r\n  }\r\n`;\r\n\r\nconst Item = styled.li`\r\n  display: inline-flex;\r\n  background-color: var(--backgroundOpacity);\r\n  border-radius: 5px;\r\n  margin-right: 5px;\r\n  padding: 5px 10px;\r\n  align-items: center;\r\n\r\n  button {\r\n    opacity: 0;\r\n    width: 0;\r\n    padding: 3px 0;\r\n  }\r\n\r\n  &:hover button {\r\n    opacity: 1;\r\n    width: initial;\r\n    margin-left: 2px;\r\n    padding: 3px;\r\n  }\r\n`;\r\n\r\nconst PlaceHolder = styled.div`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  opacity: 0.6;\r\n`;\r\n"],"names":["space.P2","lineOverflow.one","space.P3","borderRadius.normal"],"mappings":"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"}