{"version":3,"file":"index.js","sources":["../../components/Dialog/index.tsx"],"sourcesContent":["import React, {\r\n  RefObject,\r\n  useEffect,\r\n  useImperativeHandle,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\n\r\nimport { TPosition } from \"util/type\";\r\nimport { createPortal } from \"react-dom\";\r\nimport styled from \"styled-components\";\r\nimport useHandleDisplay from \"hooks/useHandleDisplay\";\r\nimport usePositionDialog from \"hooks/usePositionDialog\";\r\n\r\nexport type TRefDialog = {\r\n  show: () => void;\r\n  hide: () => void;\r\n} & HTMLBaseElement;\r\n\r\ninterface IProps {\r\n  children: JSX.Element;\r\n  clickOut?: boolean;\r\n  position?: TPosition[];\r\n  setIsShow?: (...arg: any) => void;\r\n  refParent: RefObject<any>;\r\n}\r\n\r\nfunction DialogWrap({\r\n  children,\r\n  clickOut = false,\r\n  position,\r\n  setIsShow,\r\n  refParent,\r\n  setIsShowed,\r\n}: IProps & { setIsShowed: (...arg: any) => void }) {\r\n  const refContent = useRef<HTMLDivElement>(null);\r\n  const refIsShowed = useRef(false);\r\n  const { isDisplay, show, hide } = useHandleDisplay<HTMLDivElement>(\r\n    refContent,\r\n    clickOut\r\n  );\r\n\r\n  const { handlePosition } = usePositionDialog<HTMLDivElement>(\r\n    refContent,\r\n    refParent,\r\n    {\r\n      position: position || [],\r\n    }\r\n  );\r\n\r\n  useEffect(() => {\r\n    let _hide: any;\r\n\r\n    /**\r\n     * Make animation when dialog hide\r\n     */\r\n    if (!isDisplay) {\r\n      _hide = setTimeout(() => hide(), 200);\r\n    }\r\n\r\n    // Clear timeout when Dialog is un-detect\r\n    return () => {\r\n      clearTimeout(_hide);\r\n    };\r\n  }, [isDisplay, hide]);\r\n\r\n  useEffect(() => {\r\n    if (isDisplay) {\r\n      handlePosition();\r\n\r\n      // Set timeout waiting handle position, to show dialog\r\n      setTimeout(() => {\r\n        refContent.current.style.opacity = \"1\";\r\n      }, 10);\r\n    }\r\n  }, [handlePosition, isDisplay]);\r\n\r\n  useEffect(() => {\r\n    setIsShow?.(isDisplay);\r\n  }, [isDisplay, setIsShow]);\r\n\r\n  useEffect(() => {\r\n    refIsShowed.current && setIsShowed?.(isDisplay);\r\n  }, [isDisplay, setIsShowed]);\r\n\r\n  useEffect(() => {\r\n    show();\r\n    refIsShowed.current = true;\r\n  }, [show]);\r\n\r\n  return (\r\n    isDisplay &&\r\n    createPortal(\r\n      <Wrap className=\"dialog-mark\">\r\n        <WrapContent ref={refContent}>{children}</WrapContent>\r\n      </Wrap>,\r\n      document.getElementById(\"modal-root\")\r\n    )\r\n  );\r\n}\r\n\r\nexport default React.forwardRef((props: IProps, ref: any) => {\r\n  const [isShowed, setIsShowed] = useState(false);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    show(): void {\r\n      setIsShowed(true);\r\n    },\r\n\r\n    hide(): void {\r\n      setIsShowed(false);\r\n    },\r\n  }));\r\n\r\n  return isShowed && <DialogWrap setIsShowed={setIsShowed} {...props} />;\r\n});\r\n\r\nconst Wrap = styled.div`\r\n  position: relative;\r\n  width: 100vw;\r\n  height: 100vh;\r\n`;\r\n\r\nconst WrapContent = styled.div`\r\n  position: absolute;\r\n  opacity: 0;\r\n  top: 0;\r\n  left: 0;\r\n`;\r\n"],"names":["usePositionDialog"],"mappings":";;;;;;AA2BA,SAAS,UAAU,CAAC,EAClB,QAAQ,EACR,QAAQ,GAAG,KAAK,EAChB,QAAQ,EACR,SAAS,EACT,SAAS,EACT,WAAW,GACqC;IAChD,MAAM,UAAU,GAAG,MAAM,CAAiB,IAAI,CAAC,CAAC;IAChD,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;IAClC,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,gBAAgB,CAChD,UAAU,EACV,QAAQ,CACT,CAAC;IAEF,MAAM,EAAE,cAAc,EAAE,GAAGA,iBAAiB,CAC1C,UAAU,EACV,SAAS,EACT;QACE,QAAQ,EAAE,QAAQ,IAAI,EAAE;KACzB,CACF,CAAC;IAEF,SAAS,CAAC;QACR,IAAI,KAAU,CAAC;;;;QAKf,IAAI,CAAC,SAAS,EAAE;YACd,KAAK,GAAG,UAAU,CAAC,MAAM,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC;SACvC;;QAGD,OAAO;YACL,YAAY,CAAC,KAAK,CAAC,CAAC;SACrB,CAAC;KACH,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC;IAEtB,SAAS,CAAC;QACR,IAAI,SAAS,EAAE;YACb,cAAc,EAAE,CAAC;;YAGjB,UAAU,CAAC;gBACT,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,GAAG,GAAG,CAAC;aACxC,EAAE,EAAE,CAAC,CAAC;SACR;KACF,EAAE,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC,CAAC;IAEhC,SAAS,CAAC;QACR,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAG,SAAS,EAAE;KACxB,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC,CAAC;IAE3B,SAAS,CAAC;QACR,WAAW,CAAC,OAAO,KAAI,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAG,SAAS,EAAC,CAAC;KACjD,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC;IAE7B,SAAS,CAAC;QACR,IAAI,EAAE,CAAC;QACP,WAAW,CAAC,OAAO,GAAG,IAAI,CAAC;KAC5B,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;IAEX,QACE,SAAS;QACT,YAAY,CACV,oBAAC,IAAI,IAAC,SAAS,EAAC,aAAa;YAC3B,oBAAC,WAAW,IAAC,GAAG,EAAE,UAAU,IAAG,QAAQ,CAAe,CACjD,EACP,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CACtC,EACD;AACJ,CAAC;AAED,YAAe,KAAK,CAAC,UAAU,CAAC,CAAC,KAAa,EAAE,GAAQ;IACtD,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAEhD,mBAAmB,CAAC,GAAG,EAAE,OAAO;QAC9B,IAAI;YACF,WAAW,CAAC,IAAI,CAAC,CAAC;SACnB;QAED,IAAI;YACF,WAAW,CAAC,KAAK,CAAC,CAAC;SACpB;KACF,CAAC,CAAC,CAAC;IAEJ,OAAO,QAAQ,IAAI,oBAAC,UAAU,kBAAC,WAAW,EAAE,WAAW,IAAM,KAAK,EAAI,CAAC;AACzE,CAAC,CAAC,CAAC;AAEH,MAAM,IAAI,GAAG,MAAM,CAAC,GAAG,CAAA;;;;CAItB,CAAC;AAEF,MAAM,WAAW,GAAG,MAAM,CAAC,GAAG,CAAA;;;;;CAK7B;;;;"}